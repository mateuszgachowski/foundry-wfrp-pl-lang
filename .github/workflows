name: CI Workflow

on:
  push:
    tags:
      - '*'

jobs:
  build-and-test:
    runs-on: ubuntu-latest

    container:
      image: node:alpine

    steps:
    - name: Checkout Code
      uses: actions/checkout@v2

    - name: Update packages and install zip
      run: |
        apk update
        apk add zip

    - name: Install jsonlint
      run: npm install @prantlf/jsonlint -g

    - name: Test
      run: jsonlint -q --enforce-double-quotes pl-PL

    - name: Build
      run: zip -9 pl-PL.zip -r pl-PL

    - name: Upload Artifact
      if: success()
      uses: actions/upload-artifact@v2
      with:
        name: pl-PL
        path: pl-PL.zip
        if-no-files-found: error
        retention-days: 0 # '0' means the artifact will never expire
